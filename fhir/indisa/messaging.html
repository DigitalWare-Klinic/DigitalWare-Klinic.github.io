<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE HTML>
<html xml:lang="en" xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8"/>
    <title>FHIR.DIGITAL-WARE.KLINIC-API-FHIR\Messaging - FHIR v4.0.1</title>

    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <meta name="author" content="http://hl7.org/fhir"/>

    <link rel="stylesheet" href="fhir.css"/>

      <!-- Bootstrap core CSS -->
    <link rel="stylesheet" href="assets/css/bootstrap.css"/>
    <link rel="stylesheet" href="assets/css/bootstrap-fhir.css"/>

      <!-- Project extras -->
    <link rel="stylesheet" href="assets/css/project.css"/>
    <link rel="stylesheet" href="assets/css/pygments-manni.css"/>
    <link rel="stylesheet" href="assets/css/jquery-ui.css"/>
  	<link rel="stylesheet" href="assets/css/prism.css"/>
      <!-- Placeholder for child template CSS declarations -->

    <script src="fhir-table-scripts.js" type="text/javascript"> </script>

      <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
      <!-- [if lt IE 9]>
    <script src="assets/js/html5shiv.js"></script>
    <script src="assets/js/respond.min.js"></script>
    <![endif] -->

      <!-- Favicons -->
    <link sizes="144x144" rel="apple-touch-icon-precomposed" href="assets/ico/apple-touch-icon-144-precomposed.png"/>
    <link sizes="114x114" rel="apple-touch-icon-precomposed" href="assets/ico/apple-touch-icon-114-precomposed.png"/>
    <link sizes="72x72" rel="apple-touch-icon-precomposed" href="assets/ico/apple-touch-icon-72-precomposed.png"/>
    <link rel="apple-touch-icon-precomposed" href="assets/ico/apple-touch-icon-57-precomposed.png"/>
    <link rel="shortcut icon" href="assets/ico/favicon.png"/>
  </head>
  <body onload="document.body.style.opacity='1'">

	  <script src="assets/js/prism.js"></script>

    <style type="text/css">h2{--heading-prefix:"2"}
    h3,h4,h5,h6{--heading-prefix:"2"}</style>
    <div id="segment-header" class="segment">    <!-- segment-header -->
      <div class="container">    <!-- container -->
          <!-- Placeholder for child template header declarations -->

        
        <div id="ig-status">
          <p><span style="font-size:12pt;font-weight:bold">Klinic API FHIR Implementation Guide: IG Release 1 - Digital Ware S.A.</span><br/>1.0 - trial-use</p>
        </div>
      </div>   <!-- /container -->
    </div>    <!-- /segment-header -->

    <div id="segment-navbar" class="segment">    <!-- segment-navbar -->
      <div id="stripe"> </div>
      <div class="container">    <!-- container -->
          <!-- HEADER CONTENT -->

        <nav class="navbar navbar-inverse">
            <!-- status-bar -->
          <div class="container">
            <button data-target=".navbar-inverse-collapse" data-toggle="collapse" type="button" class="navbar-toggle">
              <span class="icon-bar"> </span>
              <span class="icon-bar"> </span>
              <span class="icon-bar"> </span>
            </button>
            <a href="http://hl7.org/fhir/R4/index.html" class="navbar-brand hidden">FHIR</a>
            <div class="nav-collapse collapse navbar-inverse-collapse">
              <ul class="nav navbar-nav">
  <li><a href="index.html">IG Home</a></li>
  <li><a href="toc.html">Table of Contents</a></li>
  <li><a href="artifacts.html">Artifact Index</a></li>
  <li class="dropdown">
    <a data-toggle="dropdown" href="#" class="dropdown-toggle">Support<b class="caret">
      </b>
    </a>
    <ul class="dropdown-menu">
      <li>
        <a href="http://hl7.org/fhir/R4/index.html" target="_blank">FHIR Spec <img src="external.png" style="text-align: baseline"/></a>
      </li>
        <!-- <li>
        <a href="downloads.html">Downloads</a>
      </li> -->
    </ul>
  </li>
</ul>      
            </div>    <!-- /.nav-collapse -->
          </div>    <!-- /.container -->
        </nav>    <!-- /.navbar -->
        <!-- /HEADER CONTENT -->
      </div>    <!-- /container -->
    </div>    <!-- /segment-navbar -->
      <!-- status-bar -->
    <div id="segment-breadcrumb" class="segment">    <!-- segment-breadcrumb -->
      <div class="container">    <!-- container -->
        <ul class="breadcrumb">
          <li><a href="toc.html"><b>Table of Contents</b></a></li><li><b>Messaging</b></li>
        </ul>
      </div>    <!-- /container -->
    </div>    <!-- /segment-breadcrumb -->

    <div id="segment-content">    <!-- segment-content -->
      <div class="container">    <!-- container -->
        <div class="row">
          <div class="inner-wrapper">

<style type="text/css">
h2:before{color:silver;counter-increment:section;content:var(--heading-prefix) " ";}
h3:before{color:silver;counter-increment:sub-section;content:var(--heading-prefix) "." counter(sub-section) " ";}
h4:before{color:silver;counter-increment:composite;content:var(--heading-prefix) "." counter(sub-section) "." counter(composite) " ";}
h5:before{color:silver;counter-increment:detail;content:var(--heading-prefix) "." counter(sub-section) "." counter(composite) "." counter(detail) " ";}
h6:before{color:silver;counter-increment:more-detail;content:var(--heading-prefix) "." counter(sub-section) "." counter(composite) "." counter(detail) "." counter(more-detail)" ";}
</style>
<div class="col-12">
    <!-- ReleaseHeader --><p id="publish-box">Klinic API FHIR Implementation Guide: IG Release 1 - Digital Ware S.A. - Local Development build (v1.0). See the <a href="https://digitalware-klinic.github.io/fhir/indisa/history.html">Directory of published versions</a></p>  <!-- EndReleaseHeader -->
  <h2>Messaging</h2>
  









    <p>  <!-- white space is critical inside of capture --></p>
<div class="markdown-toc">
<ul id="markdown-toc">
  <li><a href="#klinic-api-fhir---fhir-messageheader---push-notification-pattern" id="markdown-toc-klinic-api-fhir---fhir-messageheader---push-notification-pattern">Klinic API FHIR - FHIR MessageHeader - Push notification pattern.</a>    <ul>
      <li><a href="#0-fhir-messages-in-klinic-api-fhir" id="markdown-toc-0-fhir-messages-in-klinic-api-fhir">.0 FHIR messages in Klinic API FHIR.</a></li>
      <li><a href="#1-sequence-of-interactions" id="markdown-toc-1-sequence-of-interactions">.1 Sequence of interactions.</a></li>
      <li><a href="#2-event-code" id="markdown-toc-2-event-code">.2 Event code.</a></li>
      <li><a href="#3-messageheader-resource-examples" id="markdown-toc-3-messageheader-resource-examples">.3 MessageHeader resource examples.</a>        <ul>
          <li><a href="#examples-in-json-syntax" id="markdown-toc-examples-in-json-syntax">Examples in JSON syntax.</a></li>
          <li><a href="#examples-in-xml-syntax" id="markdown-toc-examples-in-xml-syntax">Examples in XML syntax.</a></li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

</div>
<h1 id="klinic-api-fhir---fhir-messageheader---push-notification-pattern">Klinic API FHIR - FHIR MessageHeader - Push notification pattern.</h1>

<p>The operation of Klinic API FHIR is based on the <em>resource-oriented architecture</em> (ROA), using <em>RESTful API</em> as an exchange mechanism, to guarantee the <em>availability</em> of information through <em>HL7 FHIR</em> resources.</p>

<p>In this way, other software applications in an organization’s information ecosystem can consult the Klinic API FHIR for the information they require through HTTP RESTful requests.</p>

<p>Using the same exchange mechanism, other authorized applications can send / publish information resources in Klinic API FHIR, which will be finally processed by Klinic HIS.</p>

<p>Section 3.1.0 of the HL7 FHIR standard documentation describes how the FHIR information resources are consulted (and managed), through the use of RESTful API.</p>

<p><a href="http://hl7.org/fhir/http.html">See documentation</a>.</p>

<h2 id="0-fhir-messages-in-klinic-api-fhir">.0 FHIR messages in Klinic API FHIR.</h2>

<p>Eventually, there are software applications whose interoperability mechanism is based on the <em>event-driven architecture</em> and require the reception of messages (generally HL7 V2x messages).</p>

<p>For these cases, Klinic API FHIR uses MessageHeader type FHIR resources, which allow notification through messaging events (push), the creation or update of certain resources.</p>

<p>Digital Ware has designed a MessageHeader resource profile (Klinic FHIR Message), used by its interoperability layer to support this notification pattern.</p>

<p>The definition of what types of resources should be notified and their delivery rules are programmed in the interoperability layer (Klinic API FHIR).</p>

<p>The MessageHeader resource sent by the interoperability layer contains a minimum payload, which is limited to the <em>type of resource</em> focus and its <em>id</em> (or eventually its end point).</p>

<p>Based on this information, the application receiving the message (MessageHeader) can proceed to consume / read (GET) the resource in Klinic API FHIR.</p>

<p>This interaction pattern in Klinic API FHIR is designed mainly for resources related to order information (MedicationRequest, ServiceRequest and SupplyRequest).</p>

<p>Number 2.47 of the HL7 FHIR standard documentation describes the structure and use of the <em>MessageHeader</em> resource.</p>

<p><a href="http://hl7.org/fhir/messageheader.html">See documentation</a>.</p>

<h2 id="1-sequence-of-interactions">.1 Sequence of interactions.</h2>

<p>The following diagram illustrates the notification pattern interaction sequence by sending MessageHeader type FHIR resources.</p>

<p><img src="./KlinicAPIFHIR-NotificationPush.png" alt="Push notification pattern"/></p>

<ol>
  <li>
    <p>Once the creation or a change is registered in an electronic health record, <em>Klinic-HIS</em> generates the equivalent FHIR resource and proceeds to send it (POST, PUT) to its interoperability layer (Klinic API FHIR).</p>
  </li>
  <li>
    <p>Klinic API FHIR processes the resource and stores it, to make it available for other software applications to consume (GET).</p>
  </li>
  <li>
    <p>For certain types of cases, in which it is necessary for another software application to be notified about the creation or update of a resource available in Klinic API FHIR, the interoperability layer is in charge of processing a series of rules and proceeds to generate a MessageHeader resource, to be sent.</p>
  </li>
  <li>
    <p>The interoperability layer sends a MessageHeader resource, which contains the focus <em>reference</em> to the type of resource and its <strong>id</strong>.</p>
  </li>
  <li>
    <p>Based on the <strong>type of resource</strong> and its <strong>id</strong>, the application receiving the message (eg: ESB) can perform the consumption/reading (GET) of the resource in Klinic API FHIR.</p>
  </li>
  <li>
    <p>If the application receiving the message is an ESB platform, according to business rules, it can proceed to transform and send (distribute) the information to other software applications in the organization’s information ecosystem.</p>
  </li>
</ol>

<h2 id="2-event-code">.2 Event code.</h2>

<p>The MessageHeader.eventCoding element contains the code that identifies the event that this message represents.</p>

<p>The following codes have been defined for the <em>Klinic FHIR Message</em> profile.</p>

<table>
  <thead>
    <tr>
      <th style="text-align: left">Code</th>
      <th style="text-align: left">Display</th>
      <th style="text-align: left">Definition</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">CREATE</td>
      <td style="text-align: left">Resource creation notification</td>
      <td style="text-align: left">Code indicating that the message event is notifying another system that a resource has been created in Klinic API FHIR.</td>
    </tr>
    <tr>
      <td style="text-align: left">UPDATE</td>
      <td style="text-align: left">Resource update notification</td>
      <td style="text-align: left">Code indicating that the message event is notifying another system that a resource has been updated in Klinic API FHIR.</td>
    </tr>
  </tbody>
</table>

<h2 id="3-messageheader-resource-examples">.3 MessageHeader resource examples.</h2>

<h3 id="examples-in-json-syntax">Examples in JSON syntax.</h3>

<p>The following example contains a MessageHeader resource to notify the creation of a ServiceRequest type resource.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{
	"resourceType": "MessageHeader",
	"id": "d3c28245-6e76-4816-8bef-07bde3c45e7c",
	"meta": {
		"lastUpdated": "2021-02-09T14:23:17-05:00"
	},
	"eventCoding": {
		"system": "http://digitalware.com.co/salud/fhir/CodeSystem/MessageEvent",
		"code": "CREATE",
		"display": "Resource creation notification"
	},
	"destination": [
		{
			"name": "ESB platform",
			"endpoint": "http://127.0.0.1:8443/esb/end-point"
		}
	],
	"source": {
		"software": "Klinic API FHIR",
		"endpoint": "http://127.0.0.1:7000/klinic-api-fhir"
	},
	"focus": [
		{
			"reference": "ServiceRequest/dc6a94cc-1946-4326-89c3-d27888a90f7e",
			"type": "ServiceRequest"
		}
	]
}
</code></pre></div></div>

<p>The following example contains an update notification MessageHeader resource of a ServiceRequest type resource.</p>

<p>This example also exposes the use of an absolute URL to refer to the focus resource (type ServiceRequest).</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{
	"resourceType": "MessageHeader",
	"id": "97848708-6ea4-4706-892d-bee737630488",
	"meta": {
		"lastUpdated": "2021-02-09T14:50:00-05:00"
	},
	"eventCoding": {
		"system": "http://digitalware.com.co/salud/fhir/CodeSystem/MessageEvent",
		"code": "UPDATE",
		"display": "Resource update notification"
	},
	"destination": [
		{
			"name": "ESB platform",
			"endpoint": "http://127.0.0.1:8443/esb/end-point"
		}
	],
	"source": {
		"software": "Klinic API FHIR",
		"endpoint": "http://127.0.0.1:7000/klinic-api-fhir"
	},
	"focus": [
		{
			"reference": "http://127.0.0.1:7000/klinic-api-fhir/ServiceRequest/dc6a94cc-1946-4326-89c3-d27888a90f7e",
			"type": "ServiceRequest"
		}
	]
}
</code></pre></div></div>

<h3 id="examples-in-xml-syntax">Examples in XML syntax.</h3>

<p>The following example contains a MessageHeader resource to notify the creation of a ServiceRequest type resource.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;MessageHeader xmlns="http://hl7.org/fhir"&gt;
    &lt;id value="d3c28245-6e76-4816-8bef-07bde3c45e7c"/&gt;
    &lt;meta&gt;
        &lt;lastUpdated value="2021-02-09T14:23:17-05:00"/&gt;
    &lt;/meta&gt;
    &lt;eventCoding&gt;
        &lt;system value="http://digitalware.com.co/salud/fhir/CodeSystem/MessageEvent"/&gt;
        &lt;code value="CREATE"/&gt;
        &lt;display value="Resource creation notification"/&gt;
    &lt;/eventCoding&gt;
    &lt;destination&gt;
        &lt;name value="ESB platform"/&gt;
        &lt;endpoint value="http://127.0.0.1:8443/esb/end-point"/&gt;
    &lt;/destination&gt;
    &lt;source&gt;
        &lt;software value="Klinic API FHIR"/&gt;
        &lt;endpoint value="http://127.0.0.1:7000/klinic-api-fhir"/&gt;
    &lt;/source&gt;
    &lt;focus&gt;
        &lt;reference value="ServiceRequest/dc6a94cc-1946-4326-89c3-d27888a90f7e"/&gt;
        &lt;type value="ServiceRequest"/&gt;
    &lt;/focus&gt;
&lt;/MessageHeader&gt;
</code></pre></div></div>

<p>The following example contains an update notification MessageHeader resource of a ServiceRequest type resource.</p>

<p>This example also exposes the use of an absolute URL to refer to the focus resource (type ServiceRequest).</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;MessageHeader xmlns="http://hl7.org/fhir"&gt;
    &lt;id value="97848708-6ea4-4706-892d-bee737630488"/&gt;
    &lt;meta&gt;
        &lt;lastUpdated value="2021-02-09T14:50:00-05:00"/&gt;
    &lt;/meta&gt;
    &lt;eventCoding&gt;
        &lt;system value="http://digitalware.com.co/salud/fhir/CodeSystem/MessageEvent"/&gt;
        &lt;code value="UPDATE"/&gt;
        &lt;display value="Resource update notification"/&gt;
    &lt;/eventCoding&gt;
    &lt;destination&gt;
        &lt;name value="ESB platform"/&gt;
        &lt;endpoint value="http://127.0.0.1:8443/esb/end-point"/&gt;
    &lt;/destination&gt;
    &lt;source&gt;
        &lt;software value="Klinic API FHIR"/&gt;
        &lt;endpoint value="http://127.0.0.1:7000/klinic-api-fhir"/&gt;
    &lt;/source&gt;
    &lt;focus&gt;
        &lt;reference value="http://127.0.0.1:7000/klinic-api-fhir/ServiceRequest/dc6a94cc-1946-4326-89c3-d27888a90f7e"/&gt;
        &lt;type value="ServiceRequest"/&gt;
    &lt;/focus&gt;
&lt;/MessageHeader&gt;
</code></pre></div></div>




</div>
        </div>    <!-- /inner-wrapper -->
      </div>    <!-- /row -->
    </div>    <!-- /container -->
  </div>    <!-- /segment-content -->

  <script src="assets/js/jquery.js" type="text/javascript"> </script>       <!-- note keep space here, otherwise it will be transformed to empty tag -> fails -->
  <script src="assets/js/jquery-ui.min.js" type="text/javascript"> </script>

  <script type="text/javascript">
    $(document).ready(function(){
      if(window.location.hash != "") {
          $('a[href="' + window.location.hash + '"]').click()
      }
    });
  </script>
  <div igtool="footer" id="segment-footer" class="segment">    <!-- segment-footer -->
    <div class="container">    <!-- container -->
      <div class="inner-wrapper">
        <p><a name="415bbbac-2d23-4881-bbe1-dcbe1cca457d">​</a>
          IG &copy; 2021+ <a style="color: #81BEF7" href="juanch@digitalware.com.co">DigitalWare S.A. - Klinic-HIS</a>.  Package fhir.digital-ware.klinic-api-fhir#1.0 based on <a style="color: #81BEF7" href="http://hl7.org/fhir/R4/">FHIR 4.0.1</a>. Generated <span title="Wed, Mar 10, 2021 01:14-0500">2021-03-10</span>
          <br/>
          <span style="color: #FFFF77">
                      Links: <a style="color: #81BEF7" href="toc.html">Table of Contents</a> |
                 <a style="color: #81BEF7" href="qa.html">QA Report</a>
          </span>
        </p>
      </div>    <!-- /inner-wrapper -->
    </div>    <!-- /container -->
  </div>    <!-- /segment-footer -->
  
  <div id="segment-post-footer" class="segment hidden">    <!-- segment-post-footer -->
    <div class="container">    <!-- container -->
    </div>    <!-- /container -->
  </div>    <!-- /segment-post-footer -->
  
    <!-- JS and analytics only. -->
    <!-- Bootstrap core JavaScript
  ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
  <script src="assets/js/bootstrap.min.js" type="text/javascript"> </script>
  <script src="assets/js/respond.min.js" type="text/javascript"> </script>
  <script src="assets/js/anchor.min.js" type="text/javascript"> </script>
  <script>anchors.options.visible = 'hover'
anchors.add()</script>
  
    <!-- Analytics Below
  ================================================== -->
  </body>
</html>